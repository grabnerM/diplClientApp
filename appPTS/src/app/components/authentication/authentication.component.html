<ion-header>
    <ion-toolbar color="primary">
        <ion-title>PTS App Login</ion-title>
    </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

    <ion-card>
        <ion-card-header>
            <ion-toolbar>
                <ion-segment color="tertiary" scrollable mode="md" [(ngModel)]="segmentModel" value="login" (ionChange)="segmentChanged($event)">
                    <ion-segment-button value="login">
                        <ion-label>Login</ion-label>
                    </ion-segment-button>
                    <ion-segment-button value="register">
                        <ion-label>Register</ion-label>
                    </ion-segment-button>
                </ion-segment>
            </ion-toolbar>
        </ion-card-header>

        <ion-card-content *ngIf="segmentModel == 'login'">

            <ion-item lines="none">
                <ion-label position="stacked">Email</ion-label>
                <ion-input type="email" placeholder="Email" name="email" [(ngModel)]="credentialsLogin.email"></ion-input>
            </ion-item>

            <ion-item lines="none">
                <ion-label position="stacked">Password</ion-label>
                <ion-input type="password" placeholder="Password" name="password" [(ngModel)]="credentialsLogin.password"></ion-input>
            </ion-item>

            <ion-button (click)="login()" expand="block">Login</ion-button>

        </ion-card-content>

        <ion-card-content *ngIf="segmentModel == 'register'">
            <form [formGroup]="registerFirstPage" *ngIf="!secondPage">
                <ion-item lines="none">
                    <ion-label position="stacked">
                        Username
                        <span *ngIf="formInputIsRequired('username')" class="required">&#42;</span>
                    </ion-label>
                    <ion-input formControlName="username" type="text" placeholder="Username" name="uname"></ion-input>
                </ion-item>

                <div *ngIf="registerFirstPage.controls.username.pending">
                    <p>Checking username...</p>
                </div>

                <div *ngIf="!registerFirstPage.controls.username.valid && !registerFirstPage.controls.username.pending && registerFirstPage.controls.username.dirty">
                    Sorry, that username can not be used!
                </div>

                <ion-item lines="none">
                    <ion-label position="stacked">
                        Firstname
                    </ion-label>
                    <ion-input formControlName="firstname" type="text" placeholder="Firstname" name="fname"></ion-input>
                </ion-item>

                <div *ngIf="!registerFirstPage.controls.firstname.valid && !registerFirstPage.controls.firstname.pending && registerFirstPage.controls.firstname.dirty">
                    Sorry, that username can not be used!
                </div>

                <ion-item lines="none">
                    <ion-label position="stacked">
                        Lastname
                    </ion-label>
                    <ion-input formControlName="lastname" type="text" placeholder="Lastname" name="lname"></ion-input>
                </ion-item>

                <div *ngIf="!registerFirstPage.controls.lastname.valid && !registerFirstPage.controls.lastname.pending && registerFirstPage.controls.lastname.dirty">
                    Sorry, that username can not be used!
                </div>

                <ion-item lines="none">
                    <ion-label position="stacked">
                        Password
                    </ion-label>
                    <ion-input formControlName="rPassword" type="password" placeholder="Password" name="pwd"></ion-input>
                </ion-item>

                <div *ngIf="!registerFirstPage.controls.rPassword.valid  && registerFirstPage.controls.rPassword.dirty">
                    Please enter a valid password.
                </div>

                <ion-item lines="none">
                    <ion-label position="stacked">
                        Confirm Password
                    </ion-label>
                    <ion-input formControlName="cPassword" type="password" placeholder="Confirm Password" name="cPwd"></ion-input>
                </ion-item>

                <div *ngIf="registerFirstPage.controls.cPassword.errors?.mustMatch && registerFirstPage.controls.cPassword.dirty">
                    Passwords must match!
                </div>

                <ion-item lines="none">
                    <ion-label position="stacked">Sex</ion-label>
                    <ion-select formControlName="sex" placeholder="Please select gender">
                        <ion-select-option value="male">Male</ion-select-option>
                        <ion-select-option value="female">Female</ion-select-option>
                        <ion-select-option value="diverse">Diverse</ion-select-option>
                    </ion-select>
                </ion-item>

                <ion-button type="submit" [disabled]="!registerFirstPage.valid" expand="block" (click)="next()">Next</ion-button>
            </form>

            <form [formGroup]="registerSecondPage" *ngIf="secondPage" (ngSubmit)="onSubmit()">
                <ion-item lines="none">
                    <ion-label position="stacked">
                        E-Mail
                    </ion-label>
                    <ion-input formControlName="email" type="mail" placeholder="E-Mail" name="mail"></ion-input>
                </ion-item>

                <ion-item lines="none">
                    <ion-label position="stacked">
                        Confirm E-Mail
                    </ion-label>
                    <ion-input formControlName="cEmail" type="mail" placeholder="Confirm E-Mail" name="cMail"></ion-input>
                </ion-item>

                <ion-item lines="none">
                    <ion-label position="stacked">
                        Area Code
                    </ion-label>
                    <ion-input formControlName="areaCode" type="text" placeholder="Area Code" name="areaCode"></ion-input>

                    <ion-label position="stacked">
                        Phone
                    </ion-label>
                    <ion-input formControlName="phone" type="text" placeholder="Phonenumber" name="phone"></ion-input>
                </ion-item>

                <ion-item lines="none">
                    <ion-label position="stacked">
                        Zip
                    </ion-label>
                    <ion-input formControlName="zip" type="text" placeholder="Zip" name="zip"></ion-input>

                    <ion-label position="stacked">
                        City
                    </ion-label>
                    <ion-input formControlName="city" type="text" placeholder="City" name="city"></ion-input>
                </ion-item>

                <ion-item lines="none">
                    <ion-label position="stacked">
                        Street
                    </ion-label>
                    <ion-input formControlName="street" type="text" placeholder="Street" name="street"></ion-input>

                    <ion-label position="stacked">
                        Housenumber
                    </ion-label>
                    <ion-input formControlName="housenumber" type="text" placeholder="Housenumber" name="housenumber"></ion-input>
                </ion-item>

                <ion-button type="submit" [disabled]="!registerSecondPage.valid" expand="block">Next</ion-button>
            </form>

        </ion-card-content>
    </ion-card>

</ion-content>